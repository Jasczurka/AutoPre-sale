pyto# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Template Manager (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è –≤–µ—Ä—Å–∏–∏ 2.0)

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ TemplateService —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –≥–æ—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤.
–ò–º–ø–æ—Ä—Ç PPTX —Ñ–∞–π–ª–æ–≤ –±–æ–ª—å—à–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API.

## –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
cd deployments
docker-compose up -d
```

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å–∫—Ä–∏–ø—Ç–∞

```bash
cd ../TemplateService/scripts
pip install -r requirements.txt
```

### –®–∞–≥ 3: –ü–µ—Ä–≤—ã–π –∏–º–ø–æ—Ä—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞
python template_manager.py list

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–µ—Ä–≤—ã–π —à–∞–±–ª–æ–Ω
python template_manager.py import /path/to/corporate_template.pptx --version 1.0
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üì• –ò–ú–ü–û–†–¢ PPTX –§–ê–ô–õ–ê
======================================================================

üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞...
‚úÖ –§–∞–π–ª –≤–∞–ª–∏–¥–µ–Ω

üìÑ –ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞: corporate_template.pptx
üìä –†–∞–∑–º–µ—Ä: 245.67 KB
‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...

======================================================================
‚úÖ –ò–ú–ü–û–†–¢ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–Å–ù
======================================================================
üìÅ File ID:       550e8400-e29b-41d4-a716-446655440000
üìÑ Filename:      corporate_template.pptx
üî¢ Blocks Count:  15
üí¨ Message:       Successfully imported 15 blocks from corporate_template.pptx

üìã –ü–æ–∫–∞–∑–∞—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏? (y/n): y
```

### –®–∞–≥ 4: –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```bash
python template_manager.py list
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üìã –ë–ò–ë–õ–ò–û–¢–ï–ö–ê –ë–õ–û–ö–û–í –ü–†–ï–ó–ï–ù–¢–ê–¶–ò–ô
======================================================================

üìä –í—Å–µ–≥–æ –±–ª–æ–∫–æ–≤: 15

üîπ TEXT (8 –±–ª–æ–∫–æ–≤)
ID (short)  Key                                      Preview
----------  ---------------------------------------  ---------
550e8400... placeholder_title_1                     ‚úì
660e8400... placeholder_subtitle_1                  ‚úì
770e8400... text_body_1                             ‚úì
...

üîπ IMAGE (4 –±–ª–æ–∫–∞)
ID (short)  Key                                      Preview
----------  ---------------------------------------  ---------
880e8400... image_main                              ‚úì
990e8400... image_logo                              ‚úì
...

üîπ TABLE (2 –±–ª–æ–∫–∞)
...

üîπ SHAPE (1 –±–ª–æ–∫)
...
```

### –®–∞–≥ 5: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª–æ–∫–µ

```bash
python template_manager.py show 550e8400-e29b-41d4-a716-446655440000
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üîç –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ë–õ–û–ö–ï
======================================================================

üÜî ID:               550e8400-e29b-41d4-a716-446655440000
üìÅ Origin File ID:   660e8400-e29b-41d4-a716-446655440000
üìÑ Slide Number:     1
üè∑Ô∏è  Type:             text
üîë Key:              placeholder_title_1

üìê –ì–ï–û–ú–ï–¢–†–ò–Ø:
   Position: x=457200, y=274638
   Size:     width=8229600, height=1143000

üìã VALUE SCHEMA:
{
  "type": "text",
  "structure": {
    "text": "string"
  }
}

üé® METADATA:
{
  "shape_type": "PLACEHOLDER",
  "font": {
    "name": "Calibri",
    "size": 44,
    "bold": true,
    "italic": false
  },
  "placeholder": {
    "type": "TITLE",
    "idx": 0
  }
}

üîó –°–°–´–õ–ö–ò:
   PPTX:    http://minio:9000/templates/660e.../corporate_template.pptx
   Preview: http://minio:9000/templates/660e.../previews/550e....png

üìÖ Created:  2025-12-23T15:30:00Z
üìÖ Updated:  2025-12-23T15:30:00Z
```

### –®–∞–≥ 6: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

```bash
# 1. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã
python template_manager.py files
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üìÅ –§–ê–ô–õ–´-–ò–°–¢–û–ß–ù–ò–ö–ò –ë–õ–û–ö–û–í
======================================================================

üìä –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 1

+----------------+--------------------------------+--------+----------------------+
| File ID (short)| Filename                       | Blocks | Types                |
+================+================================+========+======================+
| 660e8400...    | corporate_template.pptx        | 15     | text:8, image:4, ... |
+----------------+--------------------------------+--------+----------------------+

üí° –î–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞:
   python template_manager.py archive <file-id>
```

```bash
# 2. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
python template_manager.py archive 660e8400-e29b-41d4-a716-446655440000
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üóëÔ∏è  –ê–†–•–ò–í–ò–†–û–í–ê–ù–ò–ï –§–ê–ô–õ–ê-–ò–°–¢–û–ß–ù–ò–ö–ê
======================================================================

üìÅ File ID: 660e8400-e29b-41d4-a716-446655440000

‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï:
   ‚Ä¢ –§–∞–π–ª –±—É–¥–µ—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –∞—Ä—Ö–∏–≤–Ω—ã–π (soft delete)
   ‚Ä¢ –í—Å–µ –±–ª–æ–∫–∏ –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ —Å—Ç–∞–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏
   ‚Ä¢ –ë–ª–æ–∫–∏ –Ω–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –Ω–æ–≤—ã—Ö –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è—Ö
   ‚Ä¢ –§–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ù–ï –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç

‚ùì –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): yes

‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω

üí° –°–≤—è–∑–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –∏
   –Ω–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–ª–æ–∫–æ–≤
```

```bash
# 3. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
python template_manager.py import corporate_template_v2.pptx --version 2.0
```

## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

```bash
python template_manager.py interactive
```

**–í—ã–≤–æ–¥:**
```
======================================================================
üéÆ –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –†–ï–ñ–ò–ú –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–ò–ë–õ–ò–û–¢–ï–ö–û–ô
======================================================================

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
  1. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å PPTX —Ñ–∞–π–ª
  2. –ü–æ–∫–∞–∑–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –±–ª–æ–∫–æ–≤
  3. –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–æ–∫–µ
  4. –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª—ã-–∏—Å—Ç–æ—á–Ω–∏–∫–∏
  5. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª-–∏—Å—Ç–æ—á–Ω–∏–∫
  6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–∏—Å
  0. –í—ã—Ö–æ–¥

–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É (0-6): 1

üìÑ –ü—É—Ç—å –∫ PPTX —Ñ–∞–π–ª—É: templates/my_template.pptx
üî¢ –í–µ—Ä—Å–∏—è (Enter –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞): 1.5

... (–ø—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞)
```

## –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ API Gateway

```bash
# –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —á–µ—Ä–µ–∑ API Gateway
python template_manager.py --url http://localhost:8080/api/template-service list
python template_manager.py --url http://localhost:8080/api/template-service import template.pptx
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–æ–≤

### Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞

```bash
#!/bin/bash
# import_all_templates.sh

TEMPLATES_DIR="./templates"
VERSION="2024.1"

for file in "$TEMPLATES_DIR"/*.pptx; do
    echo "Importing $file..."
    python template_manager.py import "$file" --version "$VERSION"
    echo "---"
done
```

### Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```python
#!/usr/bin/env python3
import subprocess
import json

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–ª–æ–∫–æ–≤
result = subprocess.run(
    ['python', 'template_manager.py', 'list'],
    capture_output=True,
    text=True
)

# –ê–Ω–∞–ª–∏–∑ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
# ...
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "TemplateService –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
docker-compose ps template-service

# –ï—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω - –∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose up -d template-service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs template-service
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ PPTX"

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
file template.pptx
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: Microsoft PowerPoint 2007+

# 2. –û—Ç–∫—Ä—ã—Ç—å –≤ PowerPoint –∏ –ø–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç –≥—Ä—É–ø–ø
# –†–∞–∑–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã

# 4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
python template_manager.py import template.pptx
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ë–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–ª–æ–∫ –Ω–µ –∏–∑ –∞—Ä—Ö–∏–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
python template_manager.py files

# –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –±–ª–æ–∫–æ–≤
python template_manager.py list
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

### GitLab CI –ø—Ä–∏–º–µ—Ä

```yaml
deploy_templates:
  stage: deploy
  script:
    - pip install -r scripts/requirements.txt
    - python scripts/template_manager.py import templates/corporate_v${CI_COMMIT_TAG}.pptx --version ${CI_COMMIT_TAG}
  only:
    - tags
```

### GitHub Actions –ø—Ä–∏–º–µ—Ä

```yaml
name: Deploy Templates

on:
  push:
    tags:
      - 'v*'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Import template
        run: |
          pip install -r TemplateService/scripts/requirements.txt
          python TemplateService/scripts/template_manager.py import templates/template.pptx --version ${{ github.ref_name }}
```
